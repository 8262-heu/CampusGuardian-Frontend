<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Submit Complaint | Campus Guardian</title>
<link rel="stylesheet" href="../css/style.css">
<link rel="stylesheet" href="../css/dark.css">
<script defer src="../js/user-complaints.js"></script>

<style>
.page-wrap{
  max-width:720px;
  margin:auto;
  padding:30px 20px;
  animation:fadeUp .4s ease;
}
@keyframes fadeUp{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:translateY(0)}
}
.top-bar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:16px;
}
.toggle{
  cursor:pointer;
  font-size:13px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid var(--border);
}
</style>
</head>

<body>
<div class="page-wrap">

  <div class="top-bar">
    <h2>Submit Complaint</h2>
    <div class="toggle" onclick="toggleDark()">ðŸŒ™ Dark</div>
  </div>

  <p class="small-muted">
    Your complaint will be securely sent to the concerned department.
  </p>

  <div class="form-grid">

    <input id="name" placeholder="Your Name">
    <input id="email" placeholder="Your Email">

    <!-- ðŸ”¥ Department Dropdown -->
    <select id="department">
      <option value="">Loading departmentsâ€¦</option>
    </select>

    <select id="priority">
      <option value="Normal">Normal</option>
      <option value="High">High</option>
      <option value="Emergency">Emergency</option>
    </select>

    <textarea id="message" placeholder="Describe your issue clearly"></textarea>

    <button class="btn btn-primary" onclick="submitComplaintStudent()">
      Submit Complaint
    </button>

    <p id="submitMsg" class="msg"></p>

  </div>
</div>

<script>
function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("cg_dark", document.body.classList.contains("dark"));
}
if(localStorage.getItem("cg_dark")==="true"){
  document.body.classList.add("dark");
}

/* Load department list */
const DEP_API = "http://localhost:8080/api/departments";
fetch(DEP_API)
.then(r=>r.json())
.then(list=>{
  const sel = document.getElementById("department");
  sel.innerHTML = `<option value="">Select Department</option>`;
  list.forEach(d=>{
    sel.innerHTML += `<option value="${d.id}">${d.name}</option>`;
  });
})
.catch(()=>{
  document.getElementById("department").innerHTML =
    `<option value="">Failed to load departments</option>`;
});
</script>

</body>
</html>
